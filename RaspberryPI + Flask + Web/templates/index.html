<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3Team Fire System</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
    :root {
    --bg-color: #f0f2f5;
    --card-bg: #ffffff;
    --border-color: #e0e0e0;
    --text-color: #333;
    --header-color: #0a531a;
    --shadow-color: rgba(0, 0, 0, 0.952);
    --success-color: #4CAF50;
    --danger-color: #F44336;
    --button-hover: #ddd;
}

body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--bg-color);
    color: var(--text-color);
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    min-height: 100vh;
}

/* ë„¤ë¹„ê²Œì´ì…˜ ë°” */
.navbar {
    position: sticky;  /* ìŠ¤í¬ë¡¤í•´ë„ ìƒë‹¨ì— ê³ ì • */
    top: 0;
    left: 0;
    width: 97.5%;
    height: 50px;
    background: linear-gradient(90deg, #45bd65, #0f7b32);
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    z-index: 1000;   /* ë‹¤ë¥¸ ìš”ì†Œë³´ë‹¤ ìœ„ì— ì˜¤ë„ë¡ */
    border-radius: 10px 10px 0 0; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
}
.nav-left h2 {
    margin: 0;
}
.nav-right {
    display: flex;
    align-items: center;
    gap: 20px;
}
.user-info {
    font-weight: 600;
}
.logout-btn {
    background: #F44336;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    color: white;
    transition: 0.3s;
}
.logout-btn:hover {
    background: #d32f2f;
}
.notification {
    position: relative;
    cursor: pointer;
}
.badge {
    position: absolute;
    top: -6px;
    right: -8px;
    background: red;
    color: white;
    font-size: 12px;
    font-weight: bold;
    border-radius: 50%;
    padding: 3px 6px;
}


/* Increased max-width for the overall container */
.container {
    width: 95%;
    max-width: 1600px;
    margin: 20px auto;
    padding: 20px;
    background-color: var(--card-bg);
    border-radius: 12px;
    box-shadow: 0 4px 12px var(--shadow-color);
}

h1, h2, h3, h4 {
    color: var(--header-color);
    margin-top: 0;
}

.header {
    text-align: center;
    margin-bottom: 20px;
}

.dashboard-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.dashboard-buttons button {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    background-color: var(--header-color);
    color: white;
    transition: background-color 0.3s ease;
}

.dashboard-buttons button:hover {
    background-color: #283593;
}

#mainContent, #loginFormContainer {
    display: none;
    width: 100%;
}

#loginFormContainer {
    display: block;
    width: 35%;
}

.content-card {
    background-color: #fffefe;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 2px 8px var(--shadow-color);
    margin-bottom: 20px;
}

/* Two-panel layout */
.main-dashboard-wrapper {
    display: flex;
    gap: 20px;
    margin-top: 20px;
}

.dashboard-box {
    background-color: var(--card-bg);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px var(--shadow-color);
    display: flex;
    flex-direction: column;
    gap: 20px;
}

/* The left panel now takes up much more space */
.left-panel {
    flex: 3;
}

.right-panel {
    flex: 2;
}

/* Existing content within the left panel */
#outputContentContainer, #inputContent, #datalogContent {
    display: flex;
    flex-direction: column;
    gap: 20px;
    flex-grow: 1;
}

/* Video container adjusted to fill the new width */
#videoContainer {
    width: 100%;
    height: 600px;
    background-color: #000;
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    
}


/* ë¡œê·¸ í…Œì´ë¸” ì „ì²´ ë„ˆë¹„ë¡œ */
#logContainer table {
    width: 100%; /* ì™¼ìª½ íŒ¨ë„ ë„ˆë¹„ì— ë§ì¶¤ */
    border-collapse: collapse;
}

/* í…Œì´ë¸” í—¤ë” & ë°ì´í„° ì…€ */
#logContainer th, #logContainer td {
    border: 1px solid #ccc;
    padding: 8px;
    text-align: center;
    font-size: 14px;
}

/* í…Œì´ë¸”ì´ ë„ˆë¬´ ê¸¸ë©´ ê°€ë¡œ ìŠ¤í¬ë¡¤ */
#logContainer {
    overflow-x: auto;
    width: 100%;
}



#videoStream {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

/* Sensor data cards */
#sensorDataWrapper {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
    margin-top: 20px;
    flex-grow: 1;
}

.sensor-card {
    background-color: #eeeeee;
    padding: 25px 15px;
    border-radius: 8px;
    text-align: center;
    box-shadow: 0 2px 8px rgba(--shadow-color);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    width:80%;
    aspect-ratio: 1 / 1;
    display: flex;          /* ì½˜í…ì¸  ì¤‘ì•™ ì •ë ¬ */
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.sensor-card p {
    margin: 0;
    font-size: 1.2em;
    font-weight: 600;
}

.sensor-card span {
    display: block;
    font-size: 2.0em;
    font-weight: 600;
    margin-top: 5px;
}
 
.sensor-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
}

/* ì•„ì´ì½˜ */
.sensor-card .icon {
    font-size: 2.5em;
    margin-bottom: 8px;
}

/* ì„¼ì„œë³„ í…Œë§ˆ */
.card-temp { background: #cc5858; }
.card-hum { background: #6bb5f1; }
.card-moist { background: #7af07e; }
.card-fire { background: #fd9ca6; }
.card-smoke { background: #a39595; }

#logContainer table {
    width: 100%;
    border-collapse: collapse;
    border-radius: 8px;
    overflow: hidden;
}
#logContainer th {
    background-color: #0a531a;
    color: white;
    padding: 10px;
}
#logContainer td {
    padding: 8px;
    border: 1px solid #ddd;
}
#logContainer tr:nth-child(even) {
    background-color: #f9f9f9;
}
#logContainer tr:hover {
    background-color: #f1f1f1;
}

.dashboard-buttons button {
    transition: background 0.3s, transform 0.2s;
}
.dashboard-buttons button:hover {
    transform: scale(1.05);
}


.content-box {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    padding: 20px;
    margin: 15px 0;
}


.status-normal { color: var(--success-color); }
.status-alert { color: var(--danger-color); }

/* Input content and controls */
#inputContent {
    display: none;
}

#manualControls, #autoSettings {
    margin-top: 20px;
    display: none;
}
    
.control-group {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
}
    
.control-group span {
    font-weight: 600;
    flex-grow: 1;
}

.control-button-wrapper {
    display: flex;
    gap: 8px;
}

.control-button {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.control-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.on { background-color: var(--success-color); }
.off { background-color: var(--danger-color); }

.form-group {
    margin-bottom: 15px;
}
    
input[type="text"], input[type="password"], input[type="number"] {
    width: calc(100% - 22px);
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    font-size: 16px;
    margin-top: 5px;
}

.login-btn, .apply-btn {
    width: 100%;
    padding: 12px;
    background-color: var(--header-color);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 18px;
    cursor: pointer;
    margin-top: 10px;
    transition: background-color 0.3s ease;
}

.login-btn:hover, .apply-btn:hover {
    background-color: #283593;
}
    
.time-display {
    font-size: 1.2em;
    font-weight: 600;
    text-align: right;
    margin-top: 10px;
}

.setting-block {
    background-color: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 8px var(--shadow-color);
    margin-bottom: 20px;
}

.setting-block h4 {
    margin-top: 0;
}
    
.login-text {
    color: #6a6a6a;
    font-size: 14px;
    margin-top: 4px;
    text-align: center;
}
    </style>
</head>
<body>
    
<div id="loginFormContainer" class="container">
    <div class="header">
        <h1>Smart Farm Control System ğŸŒ±</h1>
        <p class="login-text">ë¡œê·¸ì¸í•˜ì—¬ ëŒ€ì‹œë³´ë“œì— ì ‘ì†í•˜ì„¸ìš”.</p>
    </div>
    <form id="loginForm">
        <div class="form-group">
            <label for="username">ì•„ì´ë””:</label>
            <input type="text" id="username" name="username" required>
        </div>
        <div class="form-group">
            <label for="password">ë¹„ë°€ë²ˆí˜¸:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <button type="submit" class="login-btn">ë¡œê·¸ì¸</button>
    </form>
</div>

<div id="mainContent" class="container">
    <nav class="navbar">
        <div class="nav-left">
            <h2>ğŸŒ± Smart Farm</h2>
        </div>
        <div class="nav-right">
            <span id="userInfo">ğŸ‘¤ Admin</span>
            <div class="notification">
                <span class="bell">ğŸ””</span>
                <span class="badge" id="alertBadge">0</span>
            </div>
            <button class="logout-btn" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </nav>

    <div class="header">
        <h1>InformationğŸŒ±</h1>
        <div class="time-display">ì‹œê°„: <span id="timeValue">--:--:--</span></div>
    </div>

    <div class="main-dashboard-wrapper">
        <div class="dashboard-box left-panel">
            <div class="dashboard-buttons">
                <button id="showOutputButton" class="content-box">ì¶œë ¥</button>
                <button id="inputButton" class="content-box">ì…ë ¥</button>
                <button id="showDataButton" class="content-box">ë°ì´í„°ì¶œë ¥</button>
            </div>
            
            <div id="outputContentContainer">
                <div id="videoContainer">
                <img id="videoStream" src="http://192.168.1.120:5000/video_feed" alt="Video Feed">
                </div>
       
                <div id="sensorDataWrapper">
                    <div class="sensor-card card-temp">
                        <div class="icon">ğŸŒ¡ï¸</div>
                        <p>ì˜¨ë„ (Â°C)</p>
                        <span id='T'>0</span>
                    </div>
                    <div class="sensor-card card-hum">
                        <div class="icon">ğŸ’§</div>
                        <p>ìŠµë„ (%)</p>
                        <span id='H'>0</span>
                    </div>
                    <div class="sensor-card card-moist">
                        <div class="icon">ğŸŒ±</div>
                        <p>ìˆ˜ë¶„ (%)</p>
                        <span id='M'>0</span>
                    </div>
                    <div class="sensor-card card-fire">
                        <div class="icon">ğŸ”¥</div>
                        <p>í™”ì¬</p>
                        <span id='F' class="status-normal">ì •ìƒ</span>
                    </div>
                    <div class="sensor-card card-smoke">
                        <div class="icon">ğŸŒ«ï¸</div>
                        <p>ì—°ê¸°</p>
                        <span id='S' class="status-normal">ì •ìƒ</span>
                    </div>
                </div>

            </div>
            
            <div id="inputContent">
                <div class="dashboard-buttons">
                    <button id="autoButton">ìë™ ëª¨ë“œ</button>
                    <button id="controlButton">ìˆ˜ë™ ëª¨ë“œ</button>
                </div>
                <div id="manualControls" class="content-card">
                    <h3>ìˆ˜ë™ ì›ê²© ì œì–´</h3>
                    <div class="control-group">
                        <span>LED ì‘ë™ :</span>
                        <div class="control-button-wrapper">
                            <button class="control-button on" id="ledOnButton">ON</button>
                            <button class="control-button off" id="ledOffButton">OFF</button>
                        </div>
                    </div>
                    <div class="control-group">
                        <span>FAN ì‘ë™ :</span>
                        <div class="control-button-wrapper">
                            <button class="control-button on" id="fanOnButton">ON</button>
                            <button class="control-button off" id="fanOffButton">OFF</button>
                        </div>
                    </div>
                    <div class="control-group">
                        <span>WATER ì‘ë™ :</span>
                        <div class="control-button-wrapper">
                            <button class="control-button on" id="waterOnButton">ON</button>
                            <button class="control-button off" id="waterOffButton">OFF</button>
                        </div>
                    </div>
                </div>
                <div id="autoSettings" class="content-card">
                    <h3>ìë™ ëª¨ë“œ ì„¤ì •</h3>
                    <div class="setting-block">
                        <h4>ì‹œê°„ ì„¤ì •</h4>
                        <div class="form-group">
                            <label for="timeOn">ON ì‹œê°„ (0~23):</label>
                            <input type="number" id="timeOn" min="0" max="23" value="6">
                        </div>
                        <div class="form-group">
                            <label for="timeOff">OFF ì‹œê°„ (0~23):</label>
                            <input type="number" id="timeOff" min="0" max="23" value="18">
                        </div>
                        <button id="setTimeButton" class="apply-btn">ì‹œê°„ ì ìš©</button>
                    </div>
                    <div class="setting-block">
                        <h4>ìë™ ì œì–´ ëª©í‘œê°’</h4>
                        <div class="form-group">
                            <label for="tempVal">ì˜¨ë„ T (Â°C):</label>
                            <input type="number" id="tempVal" value="30">
                        </div>
                        <div class="form-group">
                            <label for="humVal">ìŠµë„ H (%):</label>
                            <input type="number" id="humVal" value="70">
                        </div>
                        <div class="form-group">
                            <label for="moistVal">ìˆ˜ë¶„ M (%):</label>
                            <input type="number" id="moistVal" value="80">
                        </div>
                        <button id="setValueButton" class="apply-btn">ê°’ ì ìš©</button>
                    </div>
                </div>                
            </div>
            <div id="datalogContent" style="display:none;">
                <div class="content-card">
                    <h3>ğŸ“Š ì„¼ì„œ ë°ì´í„° ë¡œê·¸</h3>
                    <div id="logContainer"></div>
                    <button class="apply-btn" onclick="downloadCSV()">CSV ë‹¤ìš´ë¡œë“œ</button>
                </div>
            </div>
        </div>

        <div class="dashboard-box right-panel">
            <div class="content-card">
                <h3><font color="red"> Temperature_grape</font></h3>
                <canvas id="temperatureChart"></canvas>
            </div>
            <div class="content-card">
                <h3><font color="blue">Humidity_grape</font></h3>
                <canvas id="humidityChart"></canvas>
            </div>
            <div class="content-card">
                <h3><font color="green">Moisture_grape</font></h3>
                <canvas id="moistureChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>